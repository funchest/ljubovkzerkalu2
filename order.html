<!DOCTYPE html>
<html lang="en">
<head>
    <title>Любовь к Зеркалу</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1, user-scalable=no">
    <meta http-equiv="ScreenOrientation" content="autoRotate:disabled">
    <link href="https://fonts.googleapis.com/css?family=Rubik:400,700" rel="stylesheet">
    <link rel="stylesheet" href="fonts/icomoon/style.css">

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/jquery-ui.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/owl.theme.default.min.css">
    <!--
    <link rel="stylesheet" href="css/jquery.datetimepicker.min.css">
    <script src="js/jquery.datetimepicker.full.js"></script>
    -->
    <script>
        window.mobilecheck = function() {
            var check = false;
            (function(a){if(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))) check = true;})(navigator.userAgent||navigator.vendor||window.opera);
            return check;
        };
    </script>
    <script src="js/jquery-3.3.1.min.js"></script>

    <link rel="stylesheet" href="css/aos.css">

    <link rel="stylesheet" href="css/style.css">



    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

    <style>
        @keyframes slide-up {
            0% {
                opacity: 0;
                transform: translateY(20px);
            }
            100% {
                opacity: 1;
                transform: translateY(0);
            }
        }
        #tit{
            position: -webkit-sticky; /* Safari */
            position: absolute;
            top: 10%;
            left:44%;
            background-image: url('images/titlebackground.png');
            background-repeat: no-repeat;
            background-position: left;
            height: 8%;
            width: 300px;
            z-index: 1;
        }
        .date{
            animation: slide-up 0.4s ease;
        }
    </style>
</head>
<body>
<div class="site-wrap">
    <div class="site-navbar bg-white py-2">

        <div class="container">
            <div class="d-flex align-items-center justify-content-between">
                <div class="logo">
                    <div class="site-logo">
                        <a href="/" class="js-logo-clone">Любовь<span style="color:red"> к</span> Зеркалу</a>
                    </div>
                </div>
                <div class="main-nav d-none d-lg-block">
                    <nav class="site-navigation text-right text-md-center" role="navigation">
                        <ul class="site-menu js-clone-nav d-none d-lg-block">
                            <li class="has-children active">
                                <a href="index.html">Услуги</a>
                                <ul class="dropdown">
                                    <li><a href="/formen">Мужчины</a></li>
                                    <li><a href="/forwomen">Женьщины</a></li>
                                    <li><a href="/forkids">Подростки</a></li>
                                </ul>
                            </li>


                            <li><a href="../contact.html">Контакты</a></li>
                        </ul>
                    </nav>
                </div>

            </div>
        </div>
    </div>
    <div style="height:100px"></div>
    <div class="site-section">
        <div class="container">
            <div class="row">
                <div class="col-md-7">

                    <form action="/order" method="post" name = "myForm" id="theform" onsubmit = "return validateForm()">

                        <div class="p-3 p-lg-5 border">
                            <input id="5" name="ServiceID" style="display: none" placeholder="">
                            <div class="form-group row">
                                <div class="col-md-12">
                                    <label for="c_fname" class="text-black">Фамилия и имя<span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="c_fname" name="CustomerName" required>
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-12">
                                    <p class="text-black" style="font-size: 12pt;">Выберите как получить уведомление: SMS или Email</p><p class="text-black" style="font-size: 11pt;">(как минимум что-то одно)</p>
                                    <label for="c_email" class="text-black">Email</label>
                                    <input type="email" class="form-control" id="c_email" name="email" placeholder="">
                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-12">
                                    <label for="c_subject" class="text-black">Телефон <span style="font-size: 10pt;">(вам придет одно СМС напоминание)</span></label>
                                    <input type="text" id="c_subject" name="phonenum" class="form-control bfh-phone" placeholder="37212356789 (включите номер страны без плюса)">
                                </div>
                            </div>

                            <div class="mbsc-col-sm-12 mbsc-col-md-4">
                                <input id="finalDate" name="deliveryDate" style="display: none" />
                                <label for="datepicker" class="text-black">Дата<span class="text-danger">*</span></label>
                                    <!--<input id="deliveryDate" name="deliveryDate" class="form-control"  required/> -->
                                <input type="text" id="datepicker"  class="form-control" onchange="chooseday(this)" required/>
                                <div id="The_list">

                                </div>

                            </div>
<!--
                            <div class="form-group row">
                                <div class="col-lg-12">
                                    <input type="submit" class="btn btn-primary btn-lg btn-block" value="Отправить">
                                </div>
                            </div>
                            -->
                        </div>
                    </form>
                </div>

                <div class="col-md-5 ml-auto">
                    <img id="im"  alt="image" style="position: sticky" >
                </div>

                <div class="col-md-7">
                    <h4 class="text-black">Коментарии:</h4>
                    <div id="box" >
                        <!--<h5 class="text-black">Alex &nbsp;&nbsp;<span class="text-black" style="font-size: 10pt;">5/5/2015 13:30</span></h5>

                        <p class="text-black" style="word-wrap:break-word;font-size: 13pt;">&nbsp;&nbsp;&nbsp;&nbsp;zaebisj</p>
                        <h6 class="text-black">ktoto ewe</h6>
                        <p class="text-black" style="word-wrap:break-word;font-size: 13pt;">&nbsp;&nbsp;&nbsp;&nbsp;hujna</p>-->

                    </div>
                </div>

                <div class="col-md-5 ml-auto">
                    <form action="/comment" method="post" name = "commentForm" id="commentform">
                        <input id="6" name="ServiceID" style="display: none" placeholder="">
                        <p class="text-black">Оставить комментарий</p>
                        <div class="form-group">
                            <label for="cName" class="text-black">Имя</label>
                            <input type="text" name="CustomerName" class="form-control" id="cName" placeholder="" required>
                        </div>
                        <div class="form-group">
                            <label for="text" class="text-black">Комментарий</label>
                            <textarea class="form-control" id="text" name="text" rows="3" required></textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Отправить</button>
                    </form>

                </div>


            </div>
        </div>
    </div>

    <div id="formobs" style="text-align: center;">

    </div>
</div>
<p id="scrip" style="display: none;"><%= scrip %></p>
<p id="1" style="display: none;"><%= service %></p>
<p id="list" style="display: none;"><%= arr %></p>
<p id="services" style="display: none;"><%= arr2 %></p>
<p id="comments" style="display: none;"><%= arr3 %></p>
<div id="tit">
    <h2 id="theh2" style = "text-align: center; top: 50%;color: #0b0b0b"><b id="3" >закать + имя </b></h2>
    <h3 style = "font-size: 13pt; text-align: right; top: 50%;color: #0b0b0b"><i id="4" >по цене + цена </i></h3>
</div>

<script>
    var service = JSON.parse(document.getElementById("1").innerText);
    var orders = JSON.parse(document.getElementById("list").innerText);
    var comments = JSON.parse(document.getElementById("comments").innerText);
    var listOfServices = JSON.parse(document.getElementById("services").innerText);

    /*

    <h5 class="text-black">Alex &nbsp;&nbsp;<span class="text-black" style="font-size: 10pt;">5/5/2015 13:30</span></h5>
    <p class="text-black" style="word-wrap:break-word;font-size: 13pt;">&nbsp;&nbsp;&nbsp;&nbsp;zaebisj</p>
    */
    var box= document.getElementById("box");
    for(c of comments){
        var h5 = document.createElement("h5");
        var style3 = document.createAttribute("style");
        style3.value="color: #b21f2d";
        h5.setAttributeNode(style3);
        h5.classList.add("text-black");
        h5.innerHTML=c.CustomerName+"&ensp;";

        var span = document.createElement("span");
        span.classList.add("text-black");
        var style = document.createAttribute("style");
        style.value="font-size: 10pt;";
        span.setAttributeNode(style);
        span.innerText=c.date;
        h5.appendChild(span);
        box.appendChild(h5);

        var p = document.createElement("p");
        p.classList.add("text-black");
        var style2 = document.createAttribute("style");
        style2.value="word-wrap:break-word;font-size: 13pt;";
        p.setAttributeNode(style2);
        p.innerHTML="&ensp;&ensp;"+c.text;
        box.appendChild(p);
    }


    function chooseday(a){
        document.getElementById("The_list").innerHTML = "";
        var schedule=[
            [9,0],
            [9,30],
            [10,0],
            [10,30],
            [11,0],
            [11,30],
            [12,0],
            [12,30],
            [13,0],
            [13,30],
            [14,0],
            [14,30],
            [15,0],
            [15,30],
            [16,0],
            [16,30],
            [17,0],
            [17,30],
            [18,0],
            [18,30],
            [19,0],
            [19,30],
            [20,0],
            [20,30],
            [21,0],
            [21,30],
            [22,0]
        ];
        var date= document.getElementById("datepicker").value;
        var takenTime=[];
        for(o of orders) {
            //check if day is the same then proceed
            var orderDate = (o.deliveryDate).substr(0, 10);
            if (orderDate === date) {

                var h = parseInt((o.deliveryDate).substr(11, 2));
                var m = parseInt((o.deliveryDate).substr(14, 2));
                var endH = h;
                var endM = m;
                endM += o.serviceDuration;
                while (endM >= 60) {
                    endH++;
                    endM -= 60;
                }
                if (endM > 30) endM = 30;
                else if (endM < 30) endM = 0;
                takenTime.push([h, m], [endH, endM]);
                document.getElementById("finalDate").value = date;


            }

        }
        for(t of takenTime){
            var index = indexInArray(schedule,[t[0],t[1]]);
            schedule.splice(index,1);

        }
        var div = document.getElementById("The_list");
        var p = document.createElement("p");
        p.classList.add("text-black");
        p.innerText="Выберите время";
        div.appendChild(p);
        var star = document.createElement("span");
        star.classList.add("text-danger");
        star.innerText="*";
        p.appendChild(star);
        for(time of schedule){
            var formattedMin=time[1];
            if(formattedMin==0)formattedMin="0"+formattedMin;
            var btn = document.createElement("button");
            btn.classList.add("btn");
            btn.classList.add("btn-primary");//btn btn-primary btn-lg btn-block
            btn.classList.add("btn-lg");
            btn.classList.add("btn-block");
            btn.classList.add("date");
            btn.innerText=time[0]+":" + formattedMin;
            btn.onclick=function(){

                document.getElementById("finalDate").value =date+" "+this.innerText;
                console.log(document.getElementById("finalDate").value);
                document.getElementById("theform").submit();
            };

            div.appendChild(btn);

        }

    }

    function indexInArray(array, item) {
        for (var i = 0; i < array.length; i++) {
            // This if statement depends on the format of your array
            if (array[i][0] == item[0] && array[i][1] == item[1]) {
                return i;   // Found it
            }
        }
        return -1;   // Not found
    }


    function validateForm() {
        var tel=document.getElementById("c_subject").value,
            mail=document.getElementById("c_email").value,
            name=document.getElementById("c_fname").value;

        if(((( !(mail).includes("@") || !(mail).includes(".") ) && (mail).length<6) || !tel.length>9) && name.length<2)
        {
            alert("тел номер или Email неверны");
            return false
        }
        else
            {
                return true
            }

    }
</script>

<script>
    document.getElementById("3").innerText="Заказать "+service.name;
    document.getElementById("4").innerText="по цене "+service.price +"€";
    document.getElementById("5").value=service._id;
    document.getElementById("6").value=service._id;
    //document.getElementById("im").se
    var src = document.createAttribute("src");
    src.value = "../images/"+service.name+".jpg";
    document.getElementById("im").setAttributeNode(src);
    document.getElementById("im").style="width:100%;height=100%";

</script>

<script>
    $( function() {
        $( "#datepicker" ).datepicker({

        });
    } );

</script>
<script>
    //mobile version
    if(window.mobilecheck()){

        //*********************************

        var title = document.getElementById("tit");
        title.style+="width: 60%;left:17%;";
        document.getElementById("stuff").style+="margin:15%";
        /* var arr = document.getElementsByTagName("img");
         arr[0].style="width:50%;height:50%";
         for(var i=1;i<arr.length;i++){
             //d.style="margin: 15%;padding:15%";
             arr[i].style="height:30%; width:40%"
         }*/

        //*****************************************
        var div = document.getElementById("formobs");
//<p><a href="/formen" class="btn btn-outline-primary rounded-0">Заказать</a></p>
        var btn = document.createElement("a");
        var href = document.createAttribute("href");
        href.value="/formen";
        btn.setAttributeNode(href);
        btn.classList.add("btn");
        btn.classList.add("btn-outline-primary");
        btn.classList.add("rounded-0");
        var style = document.createAttribute("style");
        style.value="width: 90%;margin:2%;padding:2%";
        btn.setAttributeNode(style);
        btn.innerText="Всё для мужчин";

        var btn2 = document.createElement("a");
        var href2 = document.createAttribute("href");
        href2.value="/forwomen";
        btn2.setAttributeNode(href2);
        btn2.classList.add("btn");
        btn2.classList.add("btn-outline-primary");
        btn2.classList.add("rounded-0");
        var style2 = document.createAttribute("style");
        style2.value="width: 90%;margin:2%;padding:2%";
        btn2.setAttributeNode(style2);
        btn2.innerText="Всё для женьщин";

        var btn3 = document.createElement("a");
        var href3 = document.createAttribute("href");
        href3.value="/forkids";
        btn3.setAttributeNode(href3);
        btn3.classList.add("btn");
        btn3.classList.add("btn-outline-primary");
        btn3.classList.add("rounded-0");
        var style3 = document.createAttribute("style");
        style3.value="width: 90%;margin:2%;display: inline-block;padding:2%";
        btn3.setAttributeNode(style3);
        btn3.innerText="Всё для подростков";

        div.appendChild(btn);
        div.appendChild(btn2);
        div.appendChild(btn3);

        //<a href="contact.html">Контакты</a>
        var btn4 = document.createElement("a");
        var href4 = document.createAttribute("href");
        href4.value="contact.html";
        btn4.setAttributeNode(href4);
        var style4 = document.createAttribute("style");
        style4.value="float:right;margin:3%;display: inline-block;padding:2%";
        btn4.setAttributeNode(style4);
        btn4.innerText="Контакты";
        btn4.classList.add("btn");
        btn4.classList.add("btn-outline-primary");
        div.appendChild(btn4);

        /*var h5 = document.createElement("h5");
        var style3 = document.createAttribute("style");
        style3.value="color: #b21f2d";
        h5.setAttributeNode(style3);
        h5.classList.add("text-black");
        h5.innerHTML=c.CustomerName+"&ensp;";*/
    }
</script>


<script>
    var scrip = document.getElementById("scrip").innerText;
    
        if (scrip.length > 5) {
            alert(scrip);
        }

</script>
</body>
</html>